# 基础问题

## 01- 你们项目中哪里用到了Redis ? 

在我们的项目中很多地方都用到了Redis , Redis在我们的项目中主要有三个作用 : 

1. 使用Redis做热点数据缓存/接口数据缓存
2. 使用Redis存储一些业务数据 , 例如 : 验证码 , 用户信息 , 用户行为数据 , 数据计算结果 , 排行榜数据等
3. 使用Redis实现分布式锁 , 解决并发环境下的资源竞争问题

## 02- Redis的常用数据类型有哪些 ?

Redis 有 5 种基础数据结构，它们分别是：string(字符串)、list(列表)、hash(字典)、set(集 合) 和 zset(有序集合)



## 03- Redis的数据持久化策略有哪些 ? 

Redis 提供了两种方式，实现数据的持久化到硬盘。

1. RDB 持久化(全量)，是指在指定的时间间隔内将内存中的数据集快照写入磁盘。
2. AOF持久化(增量)，以日志的形式记录服务器所处理的每一个写、删除操作

> RDB和AOF一起使用, 在Redis4.0版本支持混合持久化方式 ( 设置 aof-use-rdb-preamble yes )



## 04- 你们使用Redis是单点还是集群 ? 哪种集群 ?

我们Redis使用的是哨兵集群 ,  一主二从 ,  三个哨兵 , 三台Linux机器



## 05- Redis集群有哪些方案, 知道嘛 ? 

我所了解的Redis集群方案 

1. 主从复制集群 :  读写分离, 一主多从 , 解决高并发读的问题
2. 哨兵集群 : 主从集群的结构之上 , 加入了哨兵用于监控集群状态 , 主节点出现故障, 执行主从切换 , 解决高可用问题
3. Cluster分片集群 : 多主多从 , 解决高并发写的问题, 以及海量数据存储问题 , 每个主节点存储一部分集群数据

## 06- 什么是 Redis 主从同步？

Redis 的主从同步(replication)机制，允许 Slave 从 Master 那里，通过网络传输拷贝到完整的数据备份，从而达到主从机制。

主数据库可以进行读写操作，当发生写操作的时候自动将数据同步到从数据库，而从数据库一般是只读的，并接收主数据库同步过来的数据。一个主数据库可以有多个从数据库，而一个从数据库只能有一个主数据库。

![image-20220527093045515](F:\授课资料\JAVAEE141期\面试资料\面试必会篇\assets\image-20220527093045515.png)

> 主从数据同步主要分二个阶段  : 
>
> **第一阶段 : 全量复制阶段**
>
> - slave节点请求增量同步
> - master节点判断replid，发现不一致，拒绝增量同步
> - master将完整内存数据生成RDB，发送RDB到slave
> - slave清空本地数据，加载master的RDB
>
> **第二阶段 : 增量复制阶段**
>
> - master将RDB期间的命令记录在repl_baklog，并持续将log中的命令发送给slave
> - slave执行接收到的命令，保持与master之间的同步



## 07- Redis分片集群中数据是怎么存储和读取的 ? 

Redis集群采用的算法是哈希槽分区算法。Redis集群中有16384个哈希槽（槽的范围是 0 -16383，哈希槽），将不同的哈希槽分布在不同的Redis节点上面进行管理，也就是说每个Redis节点只负责一部分的哈希槽。在对数据进行操作的时候，集群会对使用CRC16算法对key进行计算并对16384取模（slot = CRC16(key)%16383），得到的结果就是 Key-Value 所放入的槽，通过这个值，去找到对应的槽所对应的Redis节点，然后直接到这个对应的节点上进行存取操作



## 08- 你们用过Redis的事务吗 ? 事务的命令有哪些 ? 

Redis 作为 NoSQL 数据库也同样提供了事务机制。在 Redis 中，MULTI / EXEC / DISCARD / WATCH 这四个命令事务的相关操作命令

我们在开发过程中基本上没有用到过Redis的事务

## 09- Redis 和 Memcached 的区别有哪些？

1.  Redis 提供复杂的数据结构，丰富的数据操作 , Memcached 仅提供简单的字符串。
2.  Redis原生支持集群模式 , Memcached不支持原生集群
3.  Memcached 不支持持久化存储，重启时，数据被清空,  Redis 支持持久化存储，重启时，可以恢复已持久化的数据



## 10-  Redis中存在大量的key , 如果快速匹配到我们需要的key ? 

Redis中匹配Key的方式常用的有二种 : 

1. 使用 keys命令 

   优点 : 使用简单

   缺点 : keys是一个阻塞指令, 在扫描Redis中Key的过程中, Redis会阻塞 ,如果Key比较多 , 阻塞时间比较长 ,  影响后续命令执行

2. 使用 scan命令

   优点 : 底层使用游标定位去读取数据 , 阻塞时间比较短, 效率比较高, 建议使用Scan

   缺点 : 使用稍显麻烦, 可能会返回重复数据



## 11- Redis中如果有大量指令需要执行, 怎么执行速度比较快

可以使用Redis的批量操作指令(mset,mget....)和Pipeline指令 , Pipeline指令可以将多个指令统一发送到Redis服务端, 由Redis服务端一次执行, 减少客户端和服务端的交互次数, 所有效率比较高 , 但是注意Pipeline中组装命令不能太多，不然数据量过大，增加客户端的等待时间，造成网络阻塞，可将**大量命令拆分多个小pipeline命令**



# 项目问题 

## 01- 你们项目中文章定时发布怎么做的 ? 流程是什么样的 , 简单讲一讲







## 02- 你们项目中用到过分布式锁嘛 ? 使用什么技术做的 ? 如何实现的 ? 





## 03- 你们在使用分布式锁的过程中有没有遇到什么问题 ,如何解决的 ? 



